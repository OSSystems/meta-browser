From dd1f4ef0b01724b28860ffb39ae14b2b6bdad4d7 Mon Sep 17 00:00:00 2001
From: skandigraun <skandigraun@gmail.com>
Date: Tue, 30 May 2023 22:17:51 +0200
Subject: [PATCH] update firefox

Upstream-status: Inappropriate
---
 .cargo/config.in                    |  2 +-
 Cargo.toml                          | 92 +++++++++++++++++++++--------
 third_party/rust/suggest/Cargo.toml |  8 +--
 3 files changed, 69 insertions(+), 33 deletions(-)

diff --git a/.cargo/config.in b/.cargo/config.in
index c1348d778b..4c6d08c6ac 100644
--- a/.cargo/config.in
+++ b/.cargo/config.in
@@ -145,4 +145,4 @@ directory = "third_party/rust"
 # cargo will ignore it when it's here verbatim.
 #filter substitution
 [source."@REPLACE_NAME@"]
-directory = "@top_srcdir@/@VENDORED_DIRECTORY@"
+directory = "../../cargo_home/bitbake"
diff --git a/third_party/rust/suggest/Cargo.toml b/third_party/rust/suggest/Cargo.toml
index 6c6b5e88fc..86afb754e8 100644
--- a/third_party/rust/suggest/Cargo.toml
+++ b/third_party/rust/suggest/Cargo.toml
@@ -29,9 +29,8 @@ parking_lot = ">=0.11,<=0.12"
 serde_json = "1"
 thiserror = "1"
 uniffi = "0.24.1"
-
-[dependencies.interrupt-support]
-path = "../support/interrupt"
+interrupt-support = "0.1.0"
+sql-support = "0.1.0"
 
 [dependencies.remote_settings]
 path = "../remote_settings"
@@ -47,9 +46,6 @@ features = [
 version = "1"
 features = ["derive"]
 
-[dependencies.sql-support]
-path = "../support/sql"
-
 [dev-dependencies]
 expect-test = "1.4"
 hex = "0.4"
diff --git a/Cargo.toml b/Cargo.toml
index 4682b976d3..da623f118f 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -178,49 +178,92 @@ moz_asserts = { path = "mozglue/static/rust/moz_asserts" }
 rure = { path = "third_party/rust/rure" }
 
 # Other overrides
-chardetng = { git = "https://github.com/hsivonen/chardetng", rev = "3484d3e3ebdc8931493aa5df4d7ee9360a90e76b" }
-chardetng_c = { git = "https://github.com/hsivonen/chardetng_c", rev = "ed8a4c6f900a90d4dbc1d64b856e61490a1c3570" }
-coremidi = { git = "https://github.com/chris-zen/coremidi.git", rev = "fc68464b5445caf111e41f643a2e69ccce0b4f83" }
-cose = { git = "https://github.com/franziskuskiefer/cose-rust", rev = "43c22248d136c8b38fe42ea709d08da6355cf04b" }
+chardetng = { path = "../chardetng" }
+chardetng_c = { path = "../chardetng_c" }
+coremidi = { path = "../coremidi" }
+cose = { path = "../cose-rust" }
 firefox-on-glean = { path = "toolkit/components/glean/api" }
 icu_testdata = { path = "intl/icu_testdata" }
 libudev-sys = { path = "dom/webauthn/libudev-sys" }
-midir = { git = "https://github.com/mozilla/midir.git", rev = "519e651241e867af3391db08f9ae6400bc023e18" }
+midir = { path = "../midir" }
 # Avoid the dependency on chrono and include Android support
-minidump-writer = { git = "https://github.com/rust-minidump/minidump-writer.git", rev = "491eb330e78e310c32927e5cc3bd2350af1e93f8" }
+minidump-writer = { path = "../minidump-writer", version = "0.8.1" }
 # Bump some dependencies
-minidump-common = { git = "https://github.com/rust-minidump/rust-minidump", rev = "6ae42a7f992e8a88ebee661bc77bcedb95cd671f" }
+minidump-common = { path = "../minidump-common/minidump-common", version = "0.18.0" }
 # warp 0.3.3 + https://github.com/seanmonstar/warp/pull/1007
-warp = { git = "https://github.com/glandium/warp", rev = "4af45fae95bc98b0eba1ef0db17e1dac471bb23d" }
+warp = { path = "../warp" }
 # Allow webrender to have a versioned dependency on the older crate on crates.io
 # in order to build standalone.
 malloc_size_of_derive = { path = "xpcom/rust/malloc_size_of_derive" }
 
 # application-services overrides to make updating them all simpler.
-interrupt-support = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-sql-support = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-suggest = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-sync15 = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-tabs = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-viaduct = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
-webext-storage = { git = "https://github.com/mozilla/application-services", rev = "c82bccfa500813f273f4db0ead64fc73bfa2b34c" }
+interrupt-support = { path = "../application-services/components/support/interrupt", version = "0.1.0" }
+sql-support = { path = "../application-services/components/support/sql", version = "0.1.0" }
+sync15 = { path = "../application-services/components/sync15", version = "0.1.0" }
+tabs = { path = "../application-services/components/tabs", version = "0.1.0" }
+viaduct = { path = "third_party/rust/viaduct", version = "0.1.0" }
+webext-storage = { path = "../application-services/components/webext-storage", version = "0.1.0" }
+suggest = { path = "third_party/rust/suggest" }
 
 # ICU4X 1.2 with synstructure 0.13.x / syn 2.x. When updating to next version, this should be removed.
-diplomat = { git = "https://github.com/rust-diplomat/diplomat", rev = "8d125999893fedfdf30595e97334c21ec4b18da9" }
-diplomat-runtime = { git = "https://github.com/rust-diplomat/diplomat", rev = "8d125999893fedfdf30595e97334c21ec4b18da9" }
-icu_provider_macros = { git = "https://github.com/unicode-org/icu4x", rev = "14e9a3a9857be74582abe2dfa7ab799c5eaac873" }
-yoke-derive = { git = "https://github.com/unicode-org/icu4x", rev = "14e9a3a9857be74582abe2dfa7ab799c5eaac873" }
-zerofrom-derive = { git = "https://github.com/unicode-org/icu4x", rev = "14e9a3a9857be74582abe2dfa7ab799c5eaac873" }
-zerovec-derive = { git = "https://github.com/unicode-org/icu4x", rev = "14e9a3a9857be74582abe2dfa7ab799c5eaac873" }
+diplomat = { path = "../diplomat/macro" }
+diplomat-runtime = { path = "../diplomat/runtime" }
+icu_provider_macros = { path = "../icu4x/provider/macros" }
+yoke-derive = { path = "../icu4x/utils/yoke/derive" }
+zerofrom-derive = { path = "../icu4x/utils/zerofrom/derive" }
+zerovec-derive = { path = "../icu4x/utils/zerovec/derive" }
 
 # Patch mio 0.6 to use winapi 0.3 and miow 0.3, getting rid of winapi 0.2.
 # There is not going to be new version of mio 0.6, mio now being >= 0.7.11.
 [patch.crates-io.mio]
 path = "third_party/rust/mio-0.6.23"
 
+[patch."https://github.com/mozilla-spidermonkey/jsparagus"]
+jsparagus = { path = "../jsparagus" }
+
+[patch."https://github.com/mozilla/neqo"]
+neqo-http3 = { path = "../neqo/neqo-http3", version = "0.6.5" }
+neqo-common = { path = "../neqo/neqo-common", version = "0.6.5" }
+neqo-transport = { path = "../neqo/neqo-transport", version = "0.6.5" }
+neqo-qpack = { path = "../neqo/neqo-qpack", version = "0.6.5" }
+neqo-crypto = { path = "../neqo/neqo-crypto", version = "0.6.5" }
+
+[patch."https://github.com/FirefoxGraphics/aa-stroke"]
+aa-stroke = { path = "../aa-stroke"}
+
+[patch."https://github.com/mozilla/audioipc"]
+audioipc2-client = { path = "../audioipc/client" }
+audioipc2-server = { path = "../audioipc/server" }
+
+[patch."https://github.com/mozilla/cubeb-coreaudio-rs"]
+cubeb-coreaudio = { path = "../cubeb-coreaudio" }
+
+[patch."https://github.com/mozilla/cubeb-pulse-rs"]
+cubeb-pulse = { path = "../cubeb-pulse" }
+
+[patch."https://github.com/jfkthame/mapped_hyph.git"]
+mapped_hyph = { path = "../mapped_hyph" }
+
+[patch."https://github.com/mozilla/mp4parse-rust"]
+mp4parse_capi = { path = "../mp4parse/mp4parse_capi", version = "0.17.0" }
+
 [patch."https://github.com/mozilla/uniffi-rs.git"]
-uniffi = "=0.24.3"
-uniffi_bindgen = "=0.24.3"
-uniffi_build = "=0.24.3"
-uniffi_macros = "=0.24.3"
-weedle2 = "=4.0.0"
+uniffi-example-arithmetic = { path = "../uniffi-rs/examples/arithmetic" }
+uniffi-example-geometry = { path = "../uniffi-rs/examples/geometry" }
+uniffi-example-rondpoint = { path = "../uniffi-rs/examples/rondpoint" }
+uniffi-example-sprites = { path = "../uniffi-rs/examples/sprites" }
+uniffi-example-todolist = { path = "../uniffi-rs/examples/todolist" }
+
+[patch."https://github.com/FirefoxGraphics/wpf-gpu-raster"]
+wpf-gpu-raster = { path = "../wpf-gpu-raster" }
+
+[patch."https://github.com/gfx-rs/wgpu"]
+wgpu-core = { path = "../wgpu/wgpu-core" }
+wgpu-types = { path = "../wgpu/wgpu-types" }
+wgpu-hal = { path = "../wgpu/wgpu-hal" }
+
+[patch."https://github.com/gfx-rs/naga"]
+naga = { path = "../naga" }
+
+[patch."https://github.com/gfx-rs/metal-rs/"]
+metal = { path = "../metal" }
